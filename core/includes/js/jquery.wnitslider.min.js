(function(e){var t=e("<img />").addClass("slider-background"),n=e("<div />").addClass("slider-overlay"),r=e(),i=e(),s=e(),o=[],u=-1,a=-1,f=null,l=null,c={},h=false,p="base",d={init:function(t){l=this;h=true;c={parent:"body",first:0,fade:1e3,delay:5e3,preload:true,paused:false,load:function(){},complete:function(){},walk:function(){}};e.extend(c,e.fn.wnitslider.defaults,t);c.htmlcss=c.overlaycss=c.bgcss=d.padding_adjustment(e(c.parent));delete c.htmlcss.width;d.setup_tags.call(this);d.reset_resolution_str.call(this);d.update_img_resolutions.call(this);if(c.preload)d.preload.call(this);d.jump.call(this,c.first);return e.fn.wnitslider},show:function(){if(s.length!=0){if(a>=0)e(o[a]).fadeOut(c.fade);s.fadeOut(c.fade,function(){s.remove();s=r})}var r=t.clone();r.css(c.bgcss).attr("src",e(o[u]).data("href")).bind("load",function(){if(h){e(window).bind("load resize",function(e){d.resize.call(this)})}var t=h?300:c.fade;e(o[u]).fadeIn(t);r.hide().prependTo(e(c.parent)).fadeIn(t,function(){e(c.parent).trigger("slidercomplete",[this,u]);c.complete.apply(this,[u]);if(!c.paused){e(c.parent).trigger("sliderstart",[this,u]);clearTimeout(f);f=setTimeout(function(){d.next.call(l)},c.delay)}});if(n.css("background-image")!="")n.hide().css(c.overlaycss).height(r.height()).prependTo(e(c.parent)).show();if(h){s=r;e(c.parent).trigger("sliderload",[s.get(0),u]);c.load.apply(s.get(0),[u]);h=false}if(u>=0){e(c.parent).trigger("sliderwalk",[s.get(0),u]);c.walk.apply(s.get(0),[u])}});return e.fn.wnitslider},jump:function(t){if(t!==u){a=u;u=t;d.check_steps.call(this);if(a!=u)d.show.call(this)}return e.fn.wnitslider},next:function(){return d.jump.call(this,u+1)},previous:function(){return d.jump.call(this,u-1)},check_steps:function(t){var n=o.length-1;if(u>n)u=0;else if(u<0)u=n;return e.fn.wnitslider},setup_tags:function(){r=e(l);if(Array("UL","OL").indexOf(r.prop("tagName"))!=-1)i=r;else{i=r.children("ul");if(i.length!=0)i=e(i[0]);else{i=r.children("ol");if(i.length==0)e.error("slides container must container either an OL or a UL.");else i=e(i[0])}}var t=r.data("overlay");if(typeof t!="undefined")n.css("background-image","url("+t+")");o=i.children("li");o.hide().css(c.htmlcss);if(o.length==0)e.error("slides container must contain at least one slide.");return e.fn.wnitslider},reset_resolution_str:function(){if(c.resolutions){var t=e(window).width();for(var n in c.resolutions){if(t>=c.resolutions[n]){p=n;break}}}return e.fn.wnitslider},update_img_resolutions:function(){var t=null;for(var n=0;n<o.length;n++){t=e(o[n]).data("href");if(typeof t=="undefined")e(o[n]).data("href","#");else if(p!="base")e(o[n]).data("href",t.replace("base.",p+"."))}return e.fn.wnitslider},preload:function(){var t=[];for(var n=0;n<o.length;n++){var r=e(o[n]).data("href");if(r&&r.toLowerCase()!="none"){var i=document.createElement("img");i.src=r;t.push(i)}}return e.fn.wnitslider},padding_adjustment:function(t){var n={};var r=e(t).css("padding-left");var i=e(t).css("padding-top");n.width=e(t).outerWidth();if(r!="0px")n.marginLeft="-"+r;if(i!="0px")n.marginTop="-"+i;return n},resize:function(){var t=d.padding_adjustment(c.parent);s.css(t);n.css(t).height(s.height());return e.fn.wnitslider}};e.fn.wnitslider=function(t){if(d[t])return d[t].apply(this,Array.prototype.slice.call(arguments,1));else if(typeof t==="object"||!t)return d.init.apply(this,arguments);else e.error("Method "+t+" does not exist")};e.fn.wnitslider.defaults={resolutions:{large:1800,base:760,small:480,vsmall:0}}})(jQuery)